<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:SyncTrip.Mobile.Features.Convoy.ViewModels"
             xmlns:dto="clr-namespace:SyncTrip.Shared.DTOs.Vehicles;assembly=SyncTrip.Shared"
             x:Class="SyncTrip.Mobile.Features.Convoy.Views.CreateConvoyPage"
             x:DataType="vm:CreateConvoyViewModel"
             Title="Créer un Convoi">

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="20">

            <!-- Header -->
            <Label Text="Nouveau Convoi"
                   FontSize="24"
                   FontAttributes="Bold"
                   Margin="0,20,0,10" />

            <!-- Vehicle Picker -->
            <VerticalStackLayout Spacing="8">
                <Label Text="Véhicule"
                       FontSize="14"
                       FontAttributes="Bold" />
                <Picker Title="Sélectionnez un véhicule"
                        ItemsSource="{Binding Vehicles}"
                        SelectedItem="{Binding SelectedVehicle}"
                        ItemDisplayBinding="{Binding Model}" />
            </VerticalStackLayout>

            <!-- Privacy Switch -->
            <Grid ColumnSpacing="15">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="Auto" />
                </Grid.ColumnDefinitions>

                <VerticalStackLayout Grid.Column="0" Spacing="4">
                    <Label Text="Convoi privé"
                           FontSize="16"
                           FontAttributes="Bold" />
                    <Label Text="Les membres devront être validés par le leader"
                           FontSize="12"
                           TextColor="{AppThemeBinding Light={StaticResource Gray600}, Dark={StaticResource Gray400}}" />
                </VerticalStackLayout>

                <Switch Grid.Column="1"
                        IsToggled="{Binding IsPrivate}"
                        OnColor="{StaticResource Primary}"
                        VerticalOptions="Center" />
            </Grid>

            <!-- Create Button -->
            <Button Text="Créer le convoi"
                    Command="{Binding CreateConvoyCommand}"
                    IsEnabled="{Binding IsLoading, Converter={StaticResource InvertedBoolConverter}}"
                    BackgroundColor="{StaticResource Primary}"
                    TextColor="White"
                    CornerRadius="10"
                    HeightRequest="50"
                    Margin="0,20,0,0" />

            <!-- Loading -->
            <ActivityIndicator IsRunning="{Binding IsLoading}"
                              IsVisible="{Binding IsLoading}"
                              HorizontalOptions="Center"
                              Color="{StaticResource Primary}" />

            <!-- Error Message -->
            <Frame IsVisible="{Binding ErrorMessage, Converter={StaticResource IsNotNullOrEmptyConverter}}"
                   BorderColor="{StaticResource Error}"
                   BackgroundColor="Transparent"
                   Padding="15"
                   CornerRadius="10"
                   HasShadow="False">
                <Label Text="{Binding ErrorMessage}"
                       TextColor="{StaticResource Error}"
                       HorizontalOptions="Center" />
            </Frame>

        </VerticalStackLayout>
    </ScrollView>

</ContentPage>
