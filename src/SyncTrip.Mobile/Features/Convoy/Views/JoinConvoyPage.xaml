<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:SyncTrip.Mobile.Features.Convoy.ViewModels"
             x:Class="SyncTrip.Mobile.Features.Convoy.Views.JoinConvoyPage"
             x:DataType="vm:JoinConvoyViewModel"
             Title="Rejoindre un Convoi">

    <ScrollView>
        <VerticalStackLayout Padding="20" Spacing="20">

            <!-- Header -->
            <Label Text="Rejoindre un Convoi"
                   FontSize="24"
                   FontAttributes="Bold"
                   Margin="0,20,0,10" />

            <!-- Join Code Input -->
            <VerticalStackLayout Spacing="8">
                <Label Text="Code du convoi"
                       FontSize="14"
                       FontAttributes="Bold" />
                <Entry Placeholder="Ex: K9P2XL"
                       Text="{Binding JoinCode}"
                       MaxLength="6"
                       CharacterSpacing="4"
                       FontSize="24"
                       FontAttributes="Bold"
                       HorizontalTextAlignment="Center"
                       Keyboard="Text" />
            </VerticalStackLayout>

            <!-- Vehicle Picker -->
            <VerticalStackLayout Spacing="8">
                <Label Text="Véhicule"
                       FontSize="14"
                       FontAttributes="Bold" />
                <Picker Title="Sélectionnez un véhicule"
                        ItemsSource="{Binding Vehicles}"
                        SelectedItem="{Binding SelectedVehicle}"
                        ItemDisplayBinding="{Binding Model}" />
            </VerticalStackLayout>

            <!-- Join Button -->
            <Button Text="Rejoindre"
                    Command="{Binding JoinConvoyCommand}"
                    IsEnabled="{Binding IsLoading, Converter={StaticResource InvertedBoolConverter}}"
                    BackgroundColor="{StaticResource Primary}"
                    TextColor="White"
                    CornerRadius="10"
                    HeightRequest="50"
                    Margin="0,20,0,0" />

            <!-- Loading -->
            <ActivityIndicator IsRunning="{Binding IsLoading}"
                              IsVisible="{Binding IsLoading}"
                              HorizontalOptions="Center"
                              Color="{StaticResource Primary}" />

            <!-- Error Message -->
            <Frame IsVisible="{Binding ErrorMessage, Converter={StaticResource IsNotNullOrEmptyConverter}}"
                   BorderColor="{StaticResource Error}"
                   BackgroundColor="Transparent"
                   Padding="15"
                   CornerRadius="10"
                   HasShadow="False">
                <Label Text="{Binding ErrorMessage}"
                       TextColor="{StaticResource Error}"
                       HorizontalOptions="Center" />
            </Frame>

            <!-- Success Message -->
            <Frame IsVisible="{Binding SuccessMessage, Converter={StaticResource IsNotNullOrEmptyConverter}}"
                   BorderColor="{StaticResource Success}"
                   BackgroundColor="Transparent"
                   Padding="15"
                   CornerRadius="10"
                   HasShadow="False">
                <Label Text="{Binding SuccessMessage}"
                       TextColor="{StaticResource Success}"
                       HorizontalOptions="Center" />
            </Frame>

        </VerticalStackLayout>
    </ScrollView>

</ContentPage>
